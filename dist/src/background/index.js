(function(){"use strict";function o(t){return`https://lens.google.com/uploadbyurl?url=${t}`}function n(){[{id:"search",title:"search via google.lens 🔍"},{id:"screenshot",title:"screenshot 📷"},{id:"zoom-inc",title:"zoom 🔆 +15%"},{id:"zoom-dec",title:"zoom 🔅 -15%"},{id:"brightness-inc",title:"brightness 🔆 +25%"},{id:"brightness-dec",title:"brightness 🔅 -25%"},{id:"mirror",title:"mirror 🪞"},{id:"rotate-left",title:"rotate left ↶"},{id:"rotate-right",title:"rotate right ↷"},{id:"invert",title:"invert 🙿"}].forEach(r=>browser.contextMenus.create({...r,contexts:["all"]})),browser.contextMenus.onClicked.addListener((r,e)=>{if(!(e!=null&&e.id)){console.error("Tab ID is undefined. Cannot send message.");return}switch(r.menuItemId){case"search":browser.tabs.sendMessage(e.id,{search:!0});break;case"screenshot":browser.tabs.sendMessage(e.id,{screenshot:!0});break;default:browser.tabs.sendMessage(e.id,{transform:r.menuItemId});break}})}n(),browser.runtime.onMessage.addListener((t,r)=>{var s;const e=(s=r.tab)==null?void 0:s.id;console.log(t,{tabId:e}),t.searchImageGoogle&&browser.tabs.create({url:o(t.src)}),t.captureRect&&e&&browser.tabs.captureTab(e,{rect:t.rect}).then(i=>{browser.tabs.sendMessage(e,{from:"background",uri:i,screenshot_ok:!0})})})})();
